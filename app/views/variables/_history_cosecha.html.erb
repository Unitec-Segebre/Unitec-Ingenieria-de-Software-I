<% days = lot.range_values(variable.category, variable.id) %>
<% total = sum_values_date(lot.variables.where('valorizations.assigned_at BETWEEN ? AND ?', from, to), variable.category, variable.id) %>

<thead>
  <tr>
    <th>Fecha</th>
    <th>HAS Recorridas</th>
    <th>T.M.FF</th>
    <th>Costo Cosecha</th>
    <th>Racimos Cosechados</th>
    <th>Sacos Recolectados</th>
    <th>Costo/Toneladas</th>
    <th>Racimos/HAS Totales</th>
    <th>Racimos/Plantas</th>
    <th>Sacos Recolectados / HAS</th>
    <th>Peso Racimos</th>
  </tr>
</thead>
<tbody>
  <% days.each do |f| %>
    <tr>
      <td><%= format_date(f.assigned_at.to_datetime) %></td>
      <td><%= number_to_currency(f.amount, unit: "", precision: 3) %></td>
      <td><%= number_to_currency(f.metric_tons, unit: "", precision: 3) %></td>
      <td><%= number_to_currency(f.cost_mano, unit: "Lps. ", precision: 3) %></td>
      <td><%= number_to_currency(f.clusters, unit: "", precision: 3) %></td>
      <td><%= number_to_currency(f.bags, unit: "", precision: 3) %></td>
      <td><%= number_to_currency(f.unit_cost_ton, unit: "Lps. ", precision: 3) %></td>
      <td><%= number_to_currency(f.clusters_per_amount, unit: "", precision: 3) %></td>
      <td><%= number_to_currency(f.plants, unit: "", precision: 3) %></td>
      <td><%= number_to_currency(f.bags_per_amount, unit: "", precision: 3) %></td>
      <td><%= number_to_currency(f.cluster_weight, unit: "", precision: 3) %></td>
    </tr>
  <% end %>
  <tr>
    <th>Total</th>
    <th><%= number_to_currency(total[:amount], unit: "", precision: 3) %></th>
    <th><%= number_to_currency(total[:metric_tons], unit: "", precision: 3) %></th>
    <th><%= number_to_currency(total[:cost_mano], unit: "Lps. ", precision: 3) %></th>
    <th><%= number_to_currency(total[:clusters], unit: "", precision: 3) %></th>
    <th><%= number_to_currency(total[:bags], unit: "", precision: 3) %></th>
    <th><%= number_to_currency(total[:unit_cost_ton], unit: "Lps. ", precision: 3) %></th>
    <th><%= number_to_currency(total[:clusters_per_amount], unit: "", precision: 3) %></th>
    <th><%= number_to_currency(total[:plants], unit: "", precision: 3) %></th>
    <th><%= number_to_currency(total[:bags_per_amount], unit: "", precision: 3) %></th>
    <th><%= number_to_currency(total[:cluster_weight], unit: "", precision: 3) %></th>
  </tr>
</tbody>
